---
- name: Get install script
  get_url:
    url: https://yarnpkg.com/install.sh
    dest: /tmp/install_yarn.sh
    mode: u+x

- name: Install Yarn
  shell: /tmp/install_yarn.sh --version {{ yarn_version }}
  args:
    executable: /bin/bash

# - name: Check if YARN repo is already configured.
#   stat: path={{ yarn_debian_repofile_path }}
#   register: yarn_repofile_result

# - name: Import YARN APT key.
#   apt_key:
#     url: "{{ yarn_debian_repo_gpg_key_url }}"
#     state: present
#   register: result
#   until: '"failed" not in result'
#   retries: 3
#   delay: 5
#   become: yes
#   become_user: root
#   when: not yarn_repofile_result.stat.exists

# - name: Install YARN APT repo.
#   apt_repository:
#     repo: "deb {{ yarn_debian_repo_url }}"
#     state: present
#   register: result
#   until: '"failed" not in result'
#   retries: 3
#   delay: 5
#   become: yes
#   become_user: root
#   when: not yarn_repofile_result.stat.exists

# - name: Install YARN package manager
#   become: yes
#   become_user: root
#   package:
#     name: yarn=0.23*
